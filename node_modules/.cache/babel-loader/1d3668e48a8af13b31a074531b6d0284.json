{"ast":null,"code":"/**\n * form.js - form element for blessed\n * Copyright (c) 2013-2015, Christopher Jeffrey and contributors (MIT License).\n * https://github.com/chjj/blessed\n */\n\n/**\n * Modules\n */\nvar Node = require('./node');\n\nvar Box = require('./box');\n/**\n * Form\n */\n\n\nfunction Form(options) {\n  var self = this;\n\n  if (!(this instanceof Node)) {\n    return new Form(options);\n  }\n\n  options = options || {};\n  options.ignoreKeys = true;\n  Box.call(this, options);\n\n  if (options.keys) {\n    this.screen._listenKeys(this);\n\n    this.on('element keypress', function (el, ch, key) {\n      if (key.name === 'tab' && !key.shift || el.type === 'textbox' && options.autoNext && key.name === 'enter' || key.name === 'down' || options.vi && key.name === 'j') {\n        if (el.type === 'textbox' || el.type === 'textarea') {\n          if (key.name === 'j') return;\n\n          if (key.name === 'tab') {\n            // Workaround, since we can't stop the tab from being added.\n            el.emit('keypress', null, {\n              name: 'backspace'\n            });\n          }\n\n          el.emit('keypress', '\\x1b', {\n            name: 'escape'\n          });\n        }\n\n        self.focusNext();\n        return;\n      }\n\n      if (key.name === 'tab' && key.shift || key.name === 'up' || options.vi && key.name === 'k') {\n        if (el.type === 'textbox' || el.type === 'textarea') {\n          if (key.name === 'k') return;\n          el.emit('keypress', '\\x1b', {\n            name: 'escape'\n          });\n        }\n\n        self.focusPrevious();\n        return;\n      }\n\n      if (key.name === 'escape') {\n        self.focus();\n        return;\n      }\n    });\n  }\n}\n\nForm.prototype.__proto__ = Box.prototype;\nForm.prototype.type = 'form';\n\nForm.prototype._refresh = function () {\n  // XXX Possibly remove this if statement and refresh on every focus.\n  // Also potentially only include *visible* focusable elements.\n  // This would remove the need to check for _selected.visible in previous()\n  // and next().\n  if (!this._children) {\n    var out = [];\n    this.children.forEach(function fn(el) {\n      if (el.keyable) out.push(el);\n      el.children.forEach(fn);\n    });\n    this._children = out;\n  }\n};\n\nForm.prototype._visible = function () {\n  return !!this._children.filter(function (el) {\n    return el.visible;\n  }).length;\n};\n\nForm.prototype.next = function () {\n  this._refresh();\n\n  if (!this._visible()) return;\n\n  if (!this._selected) {\n    this._selected = this._children[0];\n    if (!this._selected.visible) return this.next();\n    if (this.screen.focused !== this._selected) return this._selected;\n  }\n\n  var i = this._children.indexOf(this._selected);\n\n  if (!~i || !this._children[i + 1]) {\n    this._selected = this._children[0];\n    if (!this._selected.visible) return this.next();\n    return this._selected;\n  }\n\n  this._selected = this._children[i + 1];\n  if (!this._selected.visible) return this.next();\n  return this._selected;\n};\n\nForm.prototype.previous = function () {\n  this._refresh();\n\n  if (!this._visible()) return;\n\n  if (!this._selected) {\n    this._selected = this._children[this._children.length - 1];\n    if (!this._selected.visible) return this.previous();\n    if (this.screen.focused !== this._selected) return this._selected;\n  }\n\n  var i = this._children.indexOf(this._selected);\n\n  if (!~i || !this._children[i - 1]) {\n    this._selected = this._children[this._children.length - 1];\n    if (!this._selected.visible) return this.previous();\n    return this._selected;\n  }\n\n  this._selected = this._children[i - 1];\n  if (!this._selected.visible) return this.previous();\n  return this._selected;\n};\n\nForm.prototype.focusNext = function () {\n  var next = this.next();\n  if (next) next.focus();\n};\n\nForm.prototype.focusPrevious = function () {\n  var previous = this.previous();\n  if (previous) previous.focus();\n};\n\nForm.prototype.resetSelected = function () {\n  this._selected = null;\n};\n\nForm.prototype.focusFirst = function () {\n  this.resetSelected();\n  this.focusNext();\n};\n\nForm.prototype.focusLast = function () {\n  this.resetSelected();\n  this.focusPrevious();\n};\n\nForm.prototype.submit = function () {\n  var out = {};\n  this.children.forEach(function fn(el) {\n    if (el.value != null) {\n      var name = el.name || el.type;\n\n      if (Array.isArray(out[name])) {\n        out[name].push(el.value);\n      } else if (out[name]) {\n        out[name] = [out[name], el.value];\n      } else {\n        out[name] = el.value;\n      }\n    }\n\n    el.children.forEach(fn);\n  });\n  this.emit('submit', out);\n  return this.submission = out;\n};\n\nForm.prototype.cancel = function () {\n  this.emit('cancel');\n};\n\nForm.prototype.reset = function () {\n  this.children.forEach(function fn(el) {\n    switch (el.type) {\n      case 'screen':\n        break;\n\n      case 'box':\n        break;\n\n      case 'text':\n        break;\n\n      case 'line':\n        break;\n\n      case 'scrollable-box':\n        break;\n\n      case 'list':\n        el.select(0);\n        return;\n\n      case 'form':\n        break;\n\n      case 'input':\n        break;\n\n      case 'textbox':\n        el.clearInput();\n        return;\n\n      case 'textarea':\n        el.clearInput();\n        return;\n\n      case 'button':\n        delete el.value;\n        break;\n\n      case 'progress-bar':\n        el.setProgress(0);\n        break;\n\n      case 'file-manager':\n        el.refresh(el.options.cwd);\n        return;\n\n      case 'checkbox':\n        el.uncheck();\n        return;\n\n      case 'radio-set':\n        break;\n\n      case 'radio-button':\n        el.uncheck();\n        return;\n\n      case 'prompt':\n        break;\n\n      case 'question':\n        break;\n\n      case 'message':\n        break;\n\n      case 'info':\n        break;\n\n      case 'loading':\n        break;\n\n      case 'list-bar':\n        //el.select(0);\n        break;\n\n      case 'dir-manager':\n        el.refresh(el.options.cwd);\n        return;\n\n      case 'terminal':\n        el.write('');\n        return;\n\n      case 'image':\n        //el.clearImage();\n        return;\n    }\n\n    el.children.forEach(fn);\n  });\n  this.emit('reset');\n};\n/**\n * Expose\n */\n\n\nmodule.exports = Form;","map":{"version":3,"sources":["/Users/samianki/node_modules/blessed/lib/widgets/form.js"],"names":["Node","require","Box","Form","options","self","ignoreKeys","call","keys","screen","_listenKeys","on","el","ch","key","name","shift","type","autoNext","vi","emit","focusNext","focusPrevious","focus","prototype","__proto__","_refresh","_children","out","children","forEach","fn","keyable","push","_visible","filter","visible","length","next","_selected","focused","i","indexOf","previous","resetSelected","focusFirst","focusLast","submit","value","Array","isArray","submission","cancel","reset","select","clearInput","setProgress","refresh","cwd","uncheck","write","module","exports"],"mappings":"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","sourcesContent":["/**\n * form.js - form element for blessed\n * Copyright (c) 2013-2015, Christopher Jeffrey and contributors (MIT License).\n * https://github.com/chjj/blessed\n */\n\n/**\n * Modules\n */\n\nvar Node = require('./node');\nvar Box = require('./box');\n\n/**\n * Form\n */\n\nfunction Form(options) {\n  var self = this;\n\n  if (!(this instanceof Node)) {\n    return new Form(options);\n  }\n\n  options = options || {};\n\n  options.ignoreKeys = true;\n  Box.call(this, options);\n\n  if (options.keys) {\n    this.screen._listenKeys(this);\n    this.on('element keypress', function(el, ch, key) {\n      if ((key.name === 'tab' && !key.shift)\n          || (el.type === 'textbox' && options.autoNext && key.name === 'enter')\n          || key.name === 'down'\n          || (options.vi && key.name === 'j')) {\n        if (el.type === 'textbox' || el.type === 'textarea') {\n          if (key.name === 'j') return;\n          if (key.name === 'tab') {\n            // Workaround, since we can't stop the tab from being added.\n            el.emit('keypress', null, { name: 'backspace' });\n          }\n          el.emit('keypress', '\\x1b', { name: 'escape' });\n        }\n        self.focusNext();\n        return;\n      }\n\n      if ((key.name === 'tab' && key.shift)\n          || key.name === 'up'\n          || (options.vi && key.name === 'k')) {\n        if (el.type === 'textbox' || el.type === 'textarea') {\n          if (key.name === 'k') return;\n          el.emit('keypress', '\\x1b', { name: 'escape' });\n        }\n        self.focusPrevious();\n        return;\n      }\n\n      if (key.name === 'escape') {\n        self.focus();\n        return;\n      }\n    });\n  }\n}\n\nForm.prototype.__proto__ = Box.prototype;\n\nForm.prototype.type = 'form';\n\nForm.prototype._refresh = function() {\n  // XXX Possibly remove this if statement and refresh on every focus.\n  // Also potentially only include *visible* focusable elements.\n  // This would remove the need to check for _selected.visible in previous()\n  // and next().\n  if (!this._children) {\n    var out = [];\n\n    this.children.forEach(function fn(el) {\n      if (el.keyable) out.push(el);\n      el.children.forEach(fn);\n    });\n\n    this._children = out;\n  }\n};\n\nForm.prototype._visible = function() {\n  return !!this._children.filter(function(el) {\n    return el.visible;\n  }).length;\n};\n\nForm.prototype.next = function() {\n  this._refresh();\n\n  if (!this._visible()) return;\n\n  if (!this._selected) {\n    this._selected = this._children[0];\n    if (!this._selected.visible) return this.next();\n    if (this.screen.focused !== this._selected) return this._selected;\n  }\n\n  var i = this._children.indexOf(this._selected);\n  if (!~i || !this._children[i + 1]) {\n    this._selected = this._children[0];\n    if (!this._selected.visible) return this.next();\n    return this._selected;\n  }\n\n  this._selected = this._children[i + 1];\n  if (!this._selected.visible) return this.next();\n  return this._selected;\n};\n\nForm.prototype.previous = function() {\n  this._refresh();\n\n  if (!this._visible()) return;\n\n  if (!this._selected) {\n    this._selected = this._children[this._children.length - 1];\n    if (!this._selected.visible) return this.previous();\n    if (this.screen.focused !== this._selected) return this._selected;\n  }\n\n  var i = this._children.indexOf(this._selected);\n  if (!~i || !this._children[i - 1]) {\n    this._selected = this._children[this._children.length - 1];\n    if (!this._selected.visible) return this.previous();\n    return this._selected;\n  }\n\n  this._selected = this._children[i - 1];\n  if (!this._selected.visible) return this.previous();\n  return this._selected;\n};\n\nForm.prototype.focusNext = function() {\n  var next = this.next();\n  if (next) next.focus();\n};\n\nForm.prototype.focusPrevious = function() {\n  var previous = this.previous();\n  if (previous) previous.focus();\n};\n\nForm.prototype.resetSelected = function() {\n  this._selected = null;\n};\n\nForm.prototype.focusFirst = function() {\n  this.resetSelected();\n  this.focusNext();\n};\n\nForm.prototype.focusLast = function() {\n  this.resetSelected();\n  this.focusPrevious();\n};\n\nForm.prototype.submit = function() {\n  var out = {};\n\n  this.children.forEach(function fn(el) {\n    if (el.value != null) {\n      var name = el.name || el.type;\n      if (Array.isArray(out[name])) {\n        out[name].push(el.value);\n      } else if (out[name]) {\n        out[name] = [out[name], el.value];\n      } else {\n        out[name] = el.value;\n      }\n    }\n    el.children.forEach(fn);\n  });\n\n  this.emit('submit', out);\n\n  return this.submission = out;\n};\n\nForm.prototype.cancel = function() {\n  this.emit('cancel');\n};\n\nForm.prototype.reset = function() {\n  this.children.forEach(function fn(el) {\n    switch (el.type) {\n      case 'screen':\n        break;\n      case 'box':\n        break;\n      case 'text':\n        break;\n      case 'line':\n        break;\n      case 'scrollable-box':\n        break;\n      case 'list':\n        el.select(0);\n        return;\n      case 'form':\n        break;\n      case 'input':\n        break;\n      case 'textbox':\n        el.clearInput();\n        return;\n      case 'textarea':\n        el.clearInput();\n        return;\n      case 'button':\n        delete el.value;\n        break;\n      case 'progress-bar':\n        el.setProgress(0);\n        break;\n      case 'file-manager':\n        el.refresh(el.options.cwd);\n        return;\n      case 'checkbox':\n        el.uncheck();\n        return;\n      case 'radio-set':\n        break;\n      case 'radio-button':\n        el.uncheck();\n        return;\n      case 'prompt':\n        break;\n      case 'question':\n        break;\n      case 'message':\n        break;\n      case 'info':\n        break;\n      case 'loading':\n        break;\n      case 'list-bar':\n        //el.select(0);\n        break;\n      case 'dir-manager':\n        el.refresh(el.options.cwd);\n        return;\n      case 'terminal':\n        el.write('');\n        return;\n      case 'image':\n        //el.clearImage();\n        return;\n    }\n    el.children.forEach(fn);\n  });\n\n  this.emit('reset');\n};\n\n/**\n * Expose\n */\n\nmodule.exports = Form;\n"]},"metadata":{},"sourceType":"script"}