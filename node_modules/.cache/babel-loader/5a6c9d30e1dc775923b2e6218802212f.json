{"ast":null,"code":"/**\n * node.js - base abstract node for blessed\n * Copyright (c) 2013-2015, Christopher Jeffrey and contributors (MIT License).\n * https://github.com/chjj/blessed\n */\n\n/**\n * Modules\n */\nvar EventEmitter = require('../events').EventEmitter;\n/**\n * Node\n */\n\n\nfunction Node(options) {\n  var self = this;\n\n  var Screen = require('./screen');\n\n  if (!(this instanceof Node)) {\n    return new Node(options);\n  }\n\n  EventEmitter.call(this);\n  options = options || {};\n  this.options = options;\n  this.screen = this.screen || options.screen;\n\n  if (!this.screen) {\n    if (this.type === 'screen') {\n      this.screen = this;\n    } else if (Screen.total === 1) {\n      this.screen = Screen.global;\n    } else if (options.parent) {\n      this.screen = options.parent;\n\n      while (this.screen && this.screen.type !== 'screen') {\n        this.screen = this.screen.parent;\n      }\n    } else if (Screen.total) {\n      // This _should_ work in most cases as long as the element is appended\n      // synchronously after the screen's creation. Throw error if not.\n      this.screen = Screen.instances[Screen.instances.length - 1];\n      process.nextTick(function () {\n        if (!self.parent) {\n          throw new Error('Element (' + self.type + ')' + ' was not appended synchronously after the' + ' screen\\'s creation. Please set a `parent`' + ' or `screen` option in the element\\'s constructor' + ' if you are going to use multiple screens and' + ' append the element later.');\n        }\n      });\n    } else {\n      throw new Error('No active screen.');\n    }\n  }\n\n  this.parent = options.parent || null;\n  this.children = [];\n  this.$ = this._ = this.data = {};\n  this.uid = Node.uid++;\n  this.index = this.index != null ? this.index : -1;\n\n  if (this.type !== 'screen') {\n    this.detached = true;\n  }\n\n  if (this.parent) {\n    this.parent.append(this);\n  }\n\n  (options.children || []).forEach(this.append.bind(this));\n}\n\nNode.uid = 0;\nNode.prototype.__proto__ = EventEmitter.prototype;\nNode.prototype.type = 'node';\n\nNode.prototype.insert = function (element, i) {\n  var self = this;\n\n  if (element.screen && element.screen !== this.screen) {\n    throw new Error('Cannot switch a node\\'s screen.');\n  }\n\n  element.detach();\n  element.parent = this;\n  element.screen = this.screen;\n\n  if (i === 0) {\n    this.children.unshift(element);\n  } else if (i === this.children.length) {\n    this.children.push(element);\n  } else {\n    this.children.splice(i, 0, element);\n  }\n\n  element.emit('reparent', this);\n  this.emit('adopt', element);\n\n  (function emit(el) {\n    var n = el.detached !== self.detached;\n    el.detached = self.detached;\n    if (n) el.emit('attach');\n    el.children.forEach(emit);\n  })(element);\n\n  if (!this.screen.focused) {\n    this.screen.focused = element;\n  }\n};\n\nNode.prototype.prepend = function (element) {\n  this.insert(element, 0);\n};\n\nNode.prototype.append = function (element) {\n  this.insert(element, this.children.length);\n};\n\nNode.prototype.insertBefore = function (element, other) {\n  var i = this.children.indexOf(other);\n  if (~i) this.insert(element, i);\n};\n\nNode.prototype.insertAfter = function (element, other) {\n  var i = this.children.indexOf(other);\n  if (~i) this.insert(element, i + 1);\n};\n\nNode.prototype.remove = function (element) {\n  if (element.parent !== this) return;\n  var i = this.children.indexOf(element);\n  if (!~i) return;\n  element.clearPos();\n  element.parent = null;\n  this.children.splice(i, 1);\n  i = this.screen.clickable.indexOf(element);\n  if (~i) this.screen.clickable.splice(i, 1);\n  i = this.screen.keyable.indexOf(element);\n  if (~i) this.screen.keyable.splice(i, 1);\n  element.emit('reparent', null);\n  this.emit('remove', element);\n\n  (function emit(el) {\n    var n = el.detached !== true;\n    el.detached = true;\n    if (n) el.emit('detach');\n    el.children.forEach(emit);\n  })(element);\n\n  if (this.screen.focused === element) {\n    this.screen.rewindFocus();\n  }\n};\n\nNode.prototype.detach = function () {\n  if (this.parent) this.parent.remove(this);\n};\n\nNode.prototype.free = function () {\n  return;\n};\n\nNode.prototype.destroy = function () {\n  this.detach();\n  this.forDescendants(function (el) {\n    el.free();\n    el.destroyed = true;\n    el.emit('destroy');\n  }, this);\n};\n\nNode.prototype.forDescendants = function (iter, s) {\n  if (s) iter(this);\n  this.children.forEach(function emit(el) {\n    iter(el);\n    el.children.forEach(emit);\n  });\n};\n\nNode.prototype.forAncestors = function (iter, s) {\n  var el = this;\n  if (s) iter(this);\n\n  while (el = el.parent) {\n    iter(el);\n  }\n};\n\nNode.prototype.collectDescendants = function (s) {\n  var out = [];\n  this.forDescendants(function (el) {\n    out.push(el);\n  }, s);\n  return out;\n};\n\nNode.prototype.collectAncestors = function (s) {\n  var out = [];\n  this.forAncestors(function (el) {\n    out.push(el);\n  }, s);\n  return out;\n};\n\nNode.prototype.emitDescendants = function () {\n  var args = Array.prototype.slice(arguments),\n      iter;\n\n  if (typeof args[args.length - 1] === 'function') {\n    iter = args.pop();\n  }\n\n  return this.forDescendants(function (el) {\n    if (iter) iter(el);\n    el.emit.apply(el, args);\n  }, true);\n};\n\nNode.prototype.emitAncestors = function () {\n  var args = Array.prototype.slice(arguments),\n      iter;\n\n  if (typeof args[args.length - 1] === 'function') {\n    iter = args.pop();\n  }\n\n  return this.forAncestors(function (el) {\n    if (iter) iter(el);\n    el.emit.apply(el, args);\n  }, true);\n};\n\nNode.prototype.hasDescendant = function (target) {\n  return function find(el) {\n    for (var i = 0; i < el.children.length; i++) {\n      if (el.children[i] === target) {\n        return true;\n      }\n\n      if (find(el.children[i]) === true) {\n        return true;\n      }\n    }\n\n    return false;\n  }(this);\n};\n\nNode.prototype.hasAncestor = function (target) {\n  var el = this;\n\n  while (el = el.parent) {\n    if (el === target) return true;\n  }\n\n  return false;\n};\n\nNode.prototype.get = function (name, value) {\n  if (this.data.hasOwnProperty(name)) {\n    return this.data[name];\n  }\n\n  return value;\n};\n\nNode.prototype.set = function (name, value) {\n  return this.data[name] = value;\n};\n/**\n * Expose\n */\n\n\nmodule.exports = Node;","map":{"version":3,"sources":["/Users/samianki/node_modules/blessed/lib/widgets/node.js"],"names":["EventEmitter","require","Node","options","self","Screen","call","screen","type","total","global","parent","instances","length","process","nextTick","Error","children","$","_","data","uid","index","detached","append","forEach","bind","prototype","__proto__","insert","element","i","detach","unshift","push","splice","emit","el","n","focused","prepend","insertBefore","other","indexOf","insertAfter","remove","clearPos","clickable","keyable","rewindFocus","free","destroy","forDescendants","destroyed","iter","s","forAncestors","collectDescendants","out","collectAncestors","emitDescendants","args","Array","slice","arguments","pop","apply","emitAncestors","hasDescendant","target","find","hasAncestor","get","name","value","hasOwnProperty","set","module","exports"],"mappings":"AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AAEA,IAAIA,YAAY,GAAGC,OAAO,CAAC,WAAD,CAAP,CAAqBD,YAAxC;AAEA;AACA;AACA;;;AAEA,SAASE,IAAT,CAAcC,OAAd,EAAuB;AACrB,MAAIC,IAAI,GAAG,IAAX;;AACA,MAAIC,MAAM,GAAGJ,OAAO,CAAC,UAAD,CAApB;;AAEA,MAAI,EAAE,gBAAgBC,IAAlB,CAAJ,EAA6B;AAC3B,WAAO,IAAIA,IAAJ,CAASC,OAAT,CAAP;AACD;;AAEDH,EAAAA,YAAY,CAACM,IAAb,CAAkB,IAAlB;AAEAH,EAAAA,OAAO,GAAGA,OAAO,IAAI,EAArB;AACA,OAAKA,OAAL,GAAeA,OAAf;AAEA,OAAKI,MAAL,GAAc,KAAKA,MAAL,IAAeJ,OAAO,CAACI,MAArC;;AAEA,MAAI,CAAC,KAAKA,MAAV,EAAkB;AAChB,QAAI,KAAKC,IAAL,KAAc,QAAlB,EAA4B;AAC1B,WAAKD,MAAL,GAAc,IAAd;AACD,KAFD,MAEO,IAAIF,MAAM,CAACI,KAAP,KAAiB,CAArB,EAAwB;AAC7B,WAAKF,MAAL,GAAcF,MAAM,CAACK,MAArB;AACD,KAFM,MAEA,IAAIP,OAAO,CAACQ,MAAZ,EAAoB;AACzB,WAAKJ,MAAL,GAAcJ,OAAO,CAACQ,MAAtB;;AACA,aAAO,KAAKJ,MAAL,IAAe,KAAKA,MAAL,CAAYC,IAAZ,KAAqB,QAA3C,EAAqD;AACnD,aAAKD,MAAL,GAAc,KAAKA,MAAL,CAAYI,MAA1B;AACD;AACF,KALM,MAKA,IAAIN,MAAM,CAACI,KAAX,EAAkB;AACvB;AACA;AACA,WAAKF,MAAL,GAAcF,MAAM,CAACO,SAAP,CAAiBP,MAAM,CAACO,SAAP,CAAiBC,MAAjB,GAA0B,CAA3C,CAAd;AACAC,MAAAA,OAAO,CAACC,QAAR,CAAiB,YAAW;AAC1B,YAAI,CAACX,IAAI,CAACO,MAAV,EAAkB;AAChB,gBAAM,IAAIK,KAAJ,CAAU,cAAcZ,IAAI,CAACI,IAAnB,GAA0B,GAA1B,GACZ,2CADY,GAEZ,4CAFY,GAGZ,mDAHY,GAIZ,+CAJY,GAKZ,4BALE,CAAN;AAMD;AACF,OATD;AAUD,KAdM,MAcA;AACL,YAAM,IAAIQ,KAAJ,CAAU,mBAAV,CAAN;AACD;AACF;;AAED,OAAKL,MAAL,GAAcR,OAAO,CAACQ,MAAR,IAAkB,IAAhC;AACA,OAAKM,QAAL,GAAgB,EAAhB;AACA,OAAKC,CAAL,GAAS,KAAKC,CAAL,GAAS,KAAKC,IAAL,GAAY,EAA9B;AACA,OAAKC,GAAL,GAAWnB,IAAI,CAACmB,GAAL,EAAX;AACA,OAAKC,KAAL,GAAa,KAAKA,KAAL,IAAc,IAAd,GAAqB,KAAKA,KAA1B,GAAkC,CAAC,CAAhD;;AAEA,MAAI,KAAKd,IAAL,KAAc,QAAlB,EAA4B;AAC1B,SAAKe,QAAL,GAAgB,IAAhB;AACD;;AAED,MAAI,KAAKZ,MAAT,EAAiB;AACf,SAAKA,MAAL,CAAYa,MAAZ,CAAmB,IAAnB;AACD;;AAED,GAACrB,OAAO,CAACc,QAAR,IAAoB,EAArB,EAAyBQ,OAAzB,CAAiC,KAAKD,MAAL,CAAYE,IAAZ,CAAiB,IAAjB,CAAjC;AACD;;AAEDxB,IAAI,CAACmB,GAAL,GAAW,CAAX;AAEAnB,IAAI,CAACyB,SAAL,CAAeC,SAAf,GAA2B5B,YAAY,CAAC2B,SAAxC;AAEAzB,IAAI,CAACyB,SAAL,CAAenB,IAAf,GAAsB,MAAtB;;AAEAN,IAAI,CAACyB,SAAL,CAAeE,MAAf,GAAwB,UAASC,OAAT,EAAkBC,CAAlB,EAAqB;AAC3C,MAAI3B,IAAI,GAAG,IAAX;;AAEA,MAAI0B,OAAO,CAACvB,MAAR,IAAkBuB,OAAO,CAACvB,MAAR,KAAmB,KAAKA,MAA9C,EAAsD;AACpD,UAAM,IAAIS,KAAJ,CAAU,iCAAV,CAAN;AACD;;AAEDc,EAAAA,OAAO,CAACE,MAAR;AACAF,EAAAA,OAAO,CAACnB,MAAR,GAAiB,IAAjB;AACAmB,EAAAA,OAAO,CAACvB,MAAR,GAAiB,KAAKA,MAAtB;;AAEA,MAAIwB,CAAC,KAAK,CAAV,EAAa;AACX,SAAKd,QAAL,CAAcgB,OAAd,CAAsBH,OAAtB;AACD,GAFD,MAEO,IAAIC,CAAC,KAAK,KAAKd,QAAL,CAAcJ,MAAxB,EAAgC;AACrC,SAAKI,QAAL,CAAciB,IAAd,CAAmBJ,OAAnB;AACD,GAFM,MAEA;AACL,SAAKb,QAAL,CAAckB,MAAd,CAAqBJ,CAArB,EAAwB,CAAxB,EAA2BD,OAA3B;AACD;;AAEDA,EAAAA,OAAO,CAACM,IAAR,CAAa,UAAb,EAAyB,IAAzB;AACA,OAAKA,IAAL,CAAU,OAAV,EAAmBN,OAAnB;;AAEA,GAAC,SAASM,IAAT,CAAcC,EAAd,EAAkB;AACjB,QAAIC,CAAC,GAAGD,EAAE,CAACd,QAAH,KAAgBnB,IAAI,CAACmB,QAA7B;AACAc,IAAAA,EAAE,CAACd,QAAH,GAAcnB,IAAI,CAACmB,QAAnB;AACA,QAAIe,CAAJ,EAAOD,EAAE,CAACD,IAAH,CAAQ,QAAR;AACPC,IAAAA,EAAE,CAACpB,QAAH,CAAYQ,OAAZ,CAAoBW,IAApB;AACD,GALD,EAKGN,OALH;;AAOA,MAAI,CAAC,KAAKvB,MAAL,CAAYgC,OAAjB,EAA0B;AACxB,SAAKhC,MAAL,CAAYgC,OAAZ,GAAsBT,OAAtB;AACD;AACF,CAhCD;;AAkCA5B,IAAI,CAACyB,SAAL,CAAea,OAAf,GAAyB,UAASV,OAAT,EAAkB;AACzC,OAAKD,MAAL,CAAYC,OAAZ,EAAqB,CAArB;AACD,CAFD;;AAIA5B,IAAI,CAACyB,SAAL,CAAeH,MAAf,GAAwB,UAASM,OAAT,EAAkB;AACxC,OAAKD,MAAL,CAAYC,OAAZ,EAAqB,KAAKb,QAAL,CAAcJ,MAAnC;AACD,CAFD;;AAIAX,IAAI,CAACyB,SAAL,CAAec,YAAf,GAA8B,UAASX,OAAT,EAAkBY,KAAlB,EAAyB;AACrD,MAAIX,CAAC,GAAG,KAAKd,QAAL,CAAc0B,OAAd,CAAsBD,KAAtB,CAAR;AACA,MAAI,CAACX,CAAL,EAAQ,KAAKF,MAAL,CAAYC,OAAZ,EAAqBC,CAArB;AACT,CAHD;;AAKA7B,IAAI,CAACyB,SAAL,CAAeiB,WAAf,GAA6B,UAASd,OAAT,EAAkBY,KAAlB,EAAyB;AACpD,MAAIX,CAAC,GAAG,KAAKd,QAAL,CAAc0B,OAAd,CAAsBD,KAAtB,CAAR;AACA,MAAI,CAACX,CAAL,EAAQ,KAAKF,MAAL,CAAYC,OAAZ,EAAqBC,CAAC,GAAG,CAAzB;AACT,CAHD;;AAKA7B,IAAI,CAACyB,SAAL,CAAekB,MAAf,GAAwB,UAASf,OAAT,EAAkB;AACxC,MAAIA,OAAO,CAACnB,MAAR,KAAmB,IAAvB,EAA6B;AAE7B,MAAIoB,CAAC,GAAG,KAAKd,QAAL,CAAc0B,OAAd,CAAsBb,OAAtB,CAAR;AACA,MAAI,CAAC,CAACC,CAAN,EAAS;AAETD,EAAAA,OAAO,CAACgB,QAAR;AAEAhB,EAAAA,OAAO,CAACnB,MAAR,GAAiB,IAAjB;AAEA,OAAKM,QAAL,CAAckB,MAAd,CAAqBJ,CAArB,EAAwB,CAAxB;AAEAA,EAAAA,CAAC,GAAG,KAAKxB,MAAL,CAAYwC,SAAZ,CAAsBJ,OAAtB,CAA8Bb,OAA9B,CAAJ;AACA,MAAI,CAACC,CAAL,EAAQ,KAAKxB,MAAL,CAAYwC,SAAZ,CAAsBZ,MAAtB,CAA6BJ,CAA7B,EAAgC,CAAhC;AACRA,EAAAA,CAAC,GAAG,KAAKxB,MAAL,CAAYyC,OAAZ,CAAoBL,OAApB,CAA4Bb,OAA5B,CAAJ;AACA,MAAI,CAACC,CAAL,EAAQ,KAAKxB,MAAL,CAAYyC,OAAZ,CAAoBb,MAApB,CAA2BJ,CAA3B,EAA8B,CAA9B;AAERD,EAAAA,OAAO,CAACM,IAAR,CAAa,UAAb,EAAyB,IAAzB;AACA,OAAKA,IAAL,CAAU,QAAV,EAAoBN,OAApB;;AAEA,GAAC,SAASM,IAAT,CAAcC,EAAd,EAAkB;AACjB,QAAIC,CAAC,GAAGD,EAAE,CAACd,QAAH,KAAgB,IAAxB;AACAc,IAAAA,EAAE,CAACd,QAAH,GAAc,IAAd;AACA,QAAIe,CAAJ,EAAOD,EAAE,CAACD,IAAH,CAAQ,QAAR;AACPC,IAAAA,EAAE,CAACpB,QAAH,CAAYQ,OAAZ,CAAoBW,IAApB;AACD,GALD,EAKGN,OALH;;AAOA,MAAI,KAAKvB,MAAL,CAAYgC,OAAZ,KAAwBT,OAA5B,EAAqC;AACnC,SAAKvB,MAAL,CAAY0C,WAAZ;AACD;AACF,CA9BD;;AAgCA/C,IAAI,CAACyB,SAAL,CAAeK,MAAf,GAAwB,YAAW;AACjC,MAAI,KAAKrB,MAAT,EAAiB,KAAKA,MAAL,CAAYkC,MAAZ,CAAmB,IAAnB;AAClB,CAFD;;AAIA3C,IAAI,CAACyB,SAAL,CAAeuB,IAAf,GAAsB,YAAW;AAC/B;AACD,CAFD;;AAIAhD,IAAI,CAACyB,SAAL,CAAewB,OAAf,GAAyB,YAAW;AAClC,OAAKnB,MAAL;AACA,OAAKoB,cAAL,CAAoB,UAASf,EAAT,EAAa;AAC/BA,IAAAA,EAAE,CAACa,IAAH;AACAb,IAAAA,EAAE,CAACgB,SAAH,GAAe,IAAf;AACAhB,IAAAA,EAAE,CAACD,IAAH,CAAQ,SAAR;AACD,GAJD,EAIG,IAJH;AAKD,CAPD;;AASAlC,IAAI,CAACyB,SAAL,CAAeyB,cAAf,GAAgC,UAASE,IAAT,EAAeC,CAAf,EAAkB;AAChD,MAAIA,CAAJ,EAAOD,IAAI,CAAC,IAAD,CAAJ;AACP,OAAKrC,QAAL,CAAcQ,OAAd,CAAsB,SAASW,IAAT,CAAcC,EAAd,EAAkB;AACtCiB,IAAAA,IAAI,CAACjB,EAAD,CAAJ;AACAA,IAAAA,EAAE,CAACpB,QAAH,CAAYQ,OAAZ,CAAoBW,IAApB;AACD,GAHD;AAID,CAND;;AAQAlC,IAAI,CAACyB,SAAL,CAAe6B,YAAf,GAA8B,UAASF,IAAT,EAAeC,CAAf,EAAkB;AAC9C,MAAIlB,EAAE,GAAG,IAAT;AACA,MAAIkB,CAAJ,EAAOD,IAAI,CAAC,IAAD,CAAJ;;AACP,SAAOjB,EAAE,GAAGA,EAAE,CAAC1B,MAAf,EAAuB;AACrB2C,IAAAA,IAAI,CAACjB,EAAD,CAAJ;AACD;AACF,CAND;;AAQAnC,IAAI,CAACyB,SAAL,CAAe8B,kBAAf,GAAoC,UAASF,CAAT,EAAY;AAC9C,MAAIG,GAAG,GAAG,EAAV;AACA,OAAKN,cAAL,CAAoB,UAASf,EAAT,EAAa;AAC/BqB,IAAAA,GAAG,CAACxB,IAAJ,CAASG,EAAT;AACD,GAFD,EAEGkB,CAFH;AAGA,SAAOG,GAAP;AACD,CAND;;AAQAxD,IAAI,CAACyB,SAAL,CAAegC,gBAAf,GAAkC,UAASJ,CAAT,EAAY;AAC5C,MAAIG,GAAG,GAAG,EAAV;AACA,OAAKF,YAAL,CAAkB,UAASnB,EAAT,EAAa;AAC7BqB,IAAAA,GAAG,CAACxB,IAAJ,CAASG,EAAT;AACD,GAFD,EAEGkB,CAFH;AAGA,SAAOG,GAAP;AACD,CAND;;AAQAxD,IAAI,CAACyB,SAAL,CAAeiC,eAAf,GAAiC,YAAW;AAC1C,MAAIC,IAAI,GAAGC,KAAK,CAACnC,SAAN,CAAgBoC,KAAhB,CAAsBC,SAAtB,CAAX;AAAA,MACIV,IADJ;;AAGA,MAAI,OAAOO,IAAI,CAACA,IAAI,CAAChD,MAAL,GAAc,CAAf,CAAX,KAAiC,UAArC,EAAiD;AAC/CyC,IAAAA,IAAI,GAAGO,IAAI,CAACI,GAAL,EAAP;AACD;;AAED,SAAO,KAAKb,cAAL,CAAoB,UAASf,EAAT,EAAa;AACtC,QAAIiB,IAAJ,EAAUA,IAAI,CAACjB,EAAD,CAAJ;AACVA,IAAAA,EAAE,CAACD,IAAH,CAAQ8B,KAAR,CAAc7B,EAAd,EAAkBwB,IAAlB;AACD,GAHM,EAGJ,IAHI,CAAP;AAID,CAZD;;AAcA3D,IAAI,CAACyB,SAAL,CAAewC,aAAf,GAA+B,YAAW;AACxC,MAAIN,IAAI,GAAGC,KAAK,CAACnC,SAAN,CAAgBoC,KAAhB,CAAsBC,SAAtB,CAAX;AAAA,MACIV,IADJ;;AAGA,MAAI,OAAOO,IAAI,CAACA,IAAI,CAAChD,MAAL,GAAc,CAAf,CAAX,KAAiC,UAArC,EAAiD;AAC/CyC,IAAAA,IAAI,GAAGO,IAAI,CAACI,GAAL,EAAP;AACD;;AAED,SAAO,KAAKT,YAAL,CAAkB,UAASnB,EAAT,EAAa;AACpC,QAAIiB,IAAJ,EAAUA,IAAI,CAACjB,EAAD,CAAJ;AACVA,IAAAA,EAAE,CAACD,IAAH,CAAQ8B,KAAR,CAAc7B,EAAd,EAAkBwB,IAAlB;AACD,GAHM,EAGJ,IAHI,CAAP;AAID,CAZD;;AAcA3D,IAAI,CAACyB,SAAL,CAAeyC,aAAf,GAA+B,UAASC,MAAT,EAAiB;AAC9C,SAAQ,SAASC,IAAT,CAAcjC,EAAd,EAAkB;AACxB,SAAK,IAAIN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGM,EAAE,CAACpB,QAAH,CAAYJ,MAAhC,EAAwCkB,CAAC,EAAzC,EAA6C;AAC3C,UAAIM,EAAE,CAACpB,QAAH,CAAYc,CAAZ,MAAmBsC,MAAvB,EAA+B;AAC7B,eAAO,IAAP;AACD;;AACD,UAAIC,IAAI,CAACjC,EAAE,CAACpB,QAAH,CAAYc,CAAZ,CAAD,CAAJ,KAAyB,IAA7B,EAAmC;AACjC,eAAO,IAAP;AACD;AACF;;AACD,WAAO,KAAP;AACD,GAVM,CAUJ,IAVI,CAAP;AAWD,CAZD;;AAcA7B,IAAI,CAACyB,SAAL,CAAe4C,WAAf,GAA6B,UAASF,MAAT,EAAiB;AAC5C,MAAIhC,EAAE,GAAG,IAAT;;AACA,SAAOA,EAAE,GAAGA,EAAE,CAAC1B,MAAf,EAAuB;AACrB,QAAI0B,EAAE,KAAKgC,MAAX,EAAmB,OAAO,IAAP;AACpB;;AACD,SAAO,KAAP;AACD,CAND;;AAQAnE,IAAI,CAACyB,SAAL,CAAe6C,GAAf,GAAqB,UAASC,IAAT,EAAeC,KAAf,EAAsB;AACzC,MAAI,KAAKtD,IAAL,CAAUuD,cAAV,CAAyBF,IAAzB,CAAJ,EAAoC;AAClC,WAAO,KAAKrD,IAAL,CAAUqD,IAAV,CAAP;AACD;;AACD,SAAOC,KAAP;AACD,CALD;;AAOAxE,IAAI,CAACyB,SAAL,CAAeiD,GAAf,GAAqB,UAASH,IAAT,EAAeC,KAAf,EAAsB;AACzC,SAAO,KAAKtD,IAAL,CAAUqD,IAAV,IAAkBC,KAAzB;AACD,CAFD;AAIA;AACA;AACA;;;AAEAG,MAAM,CAACC,OAAP,GAAiB5E,IAAjB","sourcesContent":["/**\n * node.js - base abstract node for blessed\n * Copyright (c) 2013-2015, Christopher Jeffrey and contributors (MIT License).\n * https://github.com/chjj/blessed\n */\n\n/**\n * Modules\n */\n\nvar EventEmitter = require('../events').EventEmitter;\n\n/**\n * Node\n */\n\nfunction Node(options) {\n  var self = this;\n  var Screen = require('./screen');\n\n  if (!(this instanceof Node)) {\n    return new Node(options);\n  }\n\n  EventEmitter.call(this);\n\n  options = options || {};\n  this.options = options;\n\n  this.screen = this.screen || options.screen;\n\n  if (!this.screen) {\n    if (this.type === 'screen') {\n      this.screen = this;\n    } else if (Screen.total === 1) {\n      this.screen = Screen.global;\n    } else if (options.parent) {\n      this.screen = options.parent;\n      while (this.screen && this.screen.type !== 'screen') {\n        this.screen = this.screen.parent;\n      }\n    } else if (Screen.total) {\n      // This _should_ work in most cases as long as the element is appended\n      // synchronously after the screen's creation. Throw error if not.\n      this.screen = Screen.instances[Screen.instances.length - 1];\n      process.nextTick(function() {\n        if (!self.parent) {\n          throw new Error('Element (' + self.type + ')'\n            + ' was not appended synchronously after the'\n            + ' screen\\'s creation. Please set a `parent`'\n            + ' or `screen` option in the element\\'s constructor'\n            + ' if you are going to use multiple screens and'\n            + ' append the element later.');\n        }\n      });\n    } else {\n      throw new Error('No active screen.');\n    }\n  }\n\n  this.parent = options.parent || null;\n  this.children = [];\n  this.$ = this._ = this.data = {};\n  this.uid = Node.uid++;\n  this.index = this.index != null ? this.index : -1;\n\n  if (this.type !== 'screen') {\n    this.detached = true;\n  }\n\n  if (this.parent) {\n    this.parent.append(this);\n  }\n\n  (options.children || []).forEach(this.append.bind(this));\n}\n\nNode.uid = 0;\n\nNode.prototype.__proto__ = EventEmitter.prototype;\n\nNode.prototype.type = 'node';\n\nNode.prototype.insert = function(element, i) {\n  var self = this;\n\n  if (element.screen && element.screen !== this.screen) {\n    throw new Error('Cannot switch a node\\'s screen.');\n  }\n\n  element.detach();\n  element.parent = this;\n  element.screen = this.screen;\n\n  if (i === 0) {\n    this.children.unshift(element);\n  } else if (i === this.children.length) {\n    this.children.push(element);\n  } else {\n    this.children.splice(i, 0, element);\n  }\n\n  element.emit('reparent', this);\n  this.emit('adopt', element);\n\n  (function emit(el) {\n    var n = el.detached !== self.detached;\n    el.detached = self.detached;\n    if (n) el.emit('attach');\n    el.children.forEach(emit);\n  })(element);\n\n  if (!this.screen.focused) {\n    this.screen.focused = element;\n  }\n};\n\nNode.prototype.prepend = function(element) {\n  this.insert(element, 0);\n};\n\nNode.prototype.append = function(element) {\n  this.insert(element, this.children.length);\n};\n\nNode.prototype.insertBefore = function(element, other) {\n  var i = this.children.indexOf(other);\n  if (~i) this.insert(element, i);\n};\n\nNode.prototype.insertAfter = function(element, other) {\n  var i = this.children.indexOf(other);\n  if (~i) this.insert(element, i + 1);\n};\n\nNode.prototype.remove = function(element) {\n  if (element.parent !== this) return;\n\n  var i = this.children.indexOf(element);\n  if (!~i) return;\n\n  element.clearPos();\n\n  element.parent = null;\n\n  this.children.splice(i, 1);\n\n  i = this.screen.clickable.indexOf(element);\n  if (~i) this.screen.clickable.splice(i, 1);\n  i = this.screen.keyable.indexOf(element);\n  if (~i) this.screen.keyable.splice(i, 1);\n\n  element.emit('reparent', null);\n  this.emit('remove', element);\n\n  (function emit(el) {\n    var n = el.detached !== true;\n    el.detached = true;\n    if (n) el.emit('detach');\n    el.children.forEach(emit);\n  })(element);\n\n  if (this.screen.focused === element) {\n    this.screen.rewindFocus();\n  }\n};\n\nNode.prototype.detach = function() {\n  if (this.parent) this.parent.remove(this);\n};\n\nNode.prototype.free = function() {\n  return;\n};\n\nNode.prototype.destroy = function() {\n  this.detach();\n  this.forDescendants(function(el) {\n    el.free();\n    el.destroyed = true;\n    el.emit('destroy');\n  }, this);\n};\n\nNode.prototype.forDescendants = function(iter, s) {\n  if (s) iter(this);\n  this.children.forEach(function emit(el) {\n    iter(el);\n    el.children.forEach(emit);\n  });\n};\n\nNode.prototype.forAncestors = function(iter, s) {\n  var el = this;\n  if (s) iter(this);\n  while (el = el.parent) {\n    iter(el);\n  }\n};\n\nNode.prototype.collectDescendants = function(s) {\n  var out = [];\n  this.forDescendants(function(el) {\n    out.push(el);\n  }, s);\n  return out;\n};\n\nNode.prototype.collectAncestors = function(s) {\n  var out = [];\n  this.forAncestors(function(el) {\n    out.push(el);\n  }, s);\n  return out;\n};\n\nNode.prototype.emitDescendants = function() {\n  var args = Array.prototype.slice(arguments)\n    , iter;\n\n  if (typeof args[args.length - 1] === 'function') {\n    iter = args.pop();\n  }\n\n  return this.forDescendants(function(el) {\n    if (iter) iter(el);\n    el.emit.apply(el, args);\n  }, true);\n};\n\nNode.prototype.emitAncestors = function() {\n  var args = Array.prototype.slice(arguments)\n    , iter;\n\n  if (typeof args[args.length - 1] === 'function') {\n    iter = args.pop();\n  }\n\n  return this.forAncestors(function(el) {\n    if (iter) iter(el);\n    el.emit.apply(el, args);\n  }, true);\n};\n\nNode.prototype.hasDescendant = function(target) {\n  return (function find(el) {\n    for (var i = 0; i < el.children.length; i++) {\n      if (el.children[i] === target) {\n        return true;\n      }\n      if (find(el.children[i]) === true) {\n        return true;\n      }\n    }\n    return false;\n  })(this);\n};\n\nNode.prototype.hasAncestor = function(target) {\n  var el = this;\n  while (el = el.parent) {\n    if (el === target) return true;\n  }\n  return false;\n};\n\nNode.prototype.get = function(name, value) {\n  if (this.data.hasOwnProperty(name)) {\n    return this.data[name];\n  }\n  return value;\n};\n\nNode.prototype.set = function(name, value) {\n  return this.data[name] = value;\n};\n\n/**\n * Expose\n */\n\nmodule.exports = Node;\n"]},"metadata":{},"sourceType":"script"}