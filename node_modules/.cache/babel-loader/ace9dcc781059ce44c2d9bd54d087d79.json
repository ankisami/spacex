{"ast":null,"code":"const cst = require('../../../constants');\n\nconst Common = require('../../Common');\n\nconst Configuration = require('../../Configuration');\n\nconst UxHelpers = require('./helpers.js');\n\nconst chalk = require('chalk');\n\nconst Table = require('cli-tableau');\n\nconst Passwd = require('../../tools/passwd.js');\n\nconst List = {};\nconst CONDENSED_MODE = (process.stdout.columns || 300) < 120;\n/**\n * Check if dump file contains same apps that the one managed by PM2\n */\n\nfunction checkIfProcessAreDumped(list) {\n  try {\n    var dump_raw = require('fs').readFileSync(cst.DUMP_FILE_PATH);\n\n    var dump = JSON.parse(dump_raw);\n    var apps_dumped = dump.map(proc => proc.name);\n    var apps_running = list.filter(proc => proc.pm2_env.pmx_module != true).map(proc => proc.name);\n    var diff = apps_dumped.filter(a => !apps_running.includes(a));\n\n    if (diff.length > 0) {\n      Common.printOut(`Current process list running is not in sync with saved list. ${chalk.italic(diff.join(' '))} differs. Type 'pm2 save' to synchronize.`);\n    } else if (apps_dumped.length != apps_running.length) {\n      Common.printOut(`Current process list running is not in sync with saved list. Type 'pm2 save' to synchronize'`);\n    }\n  } catch (e) {}\n}\n\nvar proc_id = 0;\n/**\n * List Applications and Modules managed by PM2\n */\n\nfunction listModulesAndAppsManaged(list) {\n  var name_col_size = 11;\n  if (list && list.length > 0) name_col_size = list.reduce((p, c) => p.name.length > c.name.length ? p : c).name.length + 5;\n  var app_head = {\n    id: 5,\n    name: name_col_size,\n    namespace: 13,\n    version: 9,\n    mode: 9,\n    pid: 10,\n    uptime: 8,\n    '↺': 6,\n    status: 11,\n    cpu: 10,\n    mem: 10,\n    user: 10,\n    watching: 10\n  };\n  var mod_head = {\n    id: 4,\n    module: 39,\n    version: 20,\n    pid: 7,\n    status: 10,\n    '↺': 6,\n    cpu: 10,\n    mem: 10,\n    user: 10\n  };\n\n  if (CONDENSED_MODE) {\n    app_head = {\n      id: 4,\n      name: 20,\n      mode: 10,\n      '↺': 6,\n      status: 11,\n      cpu: 10,\n      memory: 10\n    };\n    mod_head = {\n      id: 4,\n      name: 20,\n      status: 10,\n      cpu: 10,\n      mem: 10\n    };\n  }\n\n  var app_table = new Table({\n    head: Object.keys(app_head),\n    colWidths: Object.keys(app_head).map(k => app_head[k]),\n    colAligns: ['left'],\n    style: {\n      'padding-left': 1,\n      head: ['cyan', 'bold'],\n      compact: true\n    }\n  });\n  var module_table = new Table({\n    head: Object.keys(mod_head),\n    colWidths: Object.keys(mod_head).map(k => mod_head[k]),\n    colAligns: ['left'],\n    style: {\n      'padding-left': 1,\n      head: ['cyan', 'bold'],\n      compact: true\n    }\n  });\n  var sortField = 'name',\n      sortOrder = 'asc',\n      sort,\n      fields = {\n    name: 'pm2_env.name',\n    namespace: 'pm2_env.namespace',\n    pid: 'pid',\n    id: 'pm_id',\n    cpu: 'monit.cpu',\n    memory: 'monit.memory',\n    uptime: 'pm2_env.pm_uptime',\n    status: 'pm2_env.status'\n  };\n  list.sort(function (a, b) {\n    var fieldA = UxHelpers.getNestedProperty(fields[sortField], a);\n    var fieldB = UxHelpers.getNestedProperty(fields[sortField], b);\n\n    if (sortOrder === 'desc') {\n      if (fieldA > fieldB) return -1;\n      if (fieldA < fieldB) return 1;\n    } else {\n      if (fieldA < fieldB) return -1;\n      if (fieldA > fieldB) return 1;\n    }\n\n    return 0;\n  });\n  list.forEach(function (l) {\n    var obj = {};\n\n    if (l.pm2_env.pm_id > proc_id) {\n      proc_id = l.pm2_env.pm_id;\n    }\n\n    var mode = l.pm2_env.exec_mode;\n    var status = l.pm2_env.status;\n    var key = l.pm2_env.pm_id;\n    key = chalk.bold.cyan(key);\n\n    if (l.pm2_env.axm_options) {\n      var is_tracing_enabled = false;\n      if (l.pm2_env.axm_options.tracing && typeof l.pm2_env.axm_options.tracing == 'boolean' && l.pm2_env.axm_options.tracing == true) is_tracing_enabled = true;\n      if (l.pm2_env.axm_options.tracing && l.pm2_env.axm_options.tracing.enabled && typeof l.pm2_env.axm_options.tracing.enabled == 'boolean' && l.pm2_env.axm_options.tracing.enabled == true) is_tracing_enabled = true;\n      if (is_tracing_enabled == true) l.pm2_env.name = chalk.green('☵') + ' ' + l.pm2_env.name;\n      if (l.pm2_env._km_monitored) l.pm2_env.name = chalk.bold.green('◉') + ' ' + l.pm2_env.name;\n    }\n\n    if (l.pm2_env.pmx_module == true) {\n      // pm2 ls for Modules\n      obj[key] = [];\n      obj[key].push(l.name); // Module version + PID\n\n      if (!CONDENSED_MODE) {\n        var pid = l.pm2_env.axm_options.pid ? l.pm2_env.axm_options.pid : l.pid;\n        obj[key].push(l.pm2_env.version || 'N/A', pid);\n      } // Status\n\n\n      obj[key].push(UxHelpers.colorStatus(status)); // Restart\n\n      if (!CONDENSED_MODE) obj[key].push(l.pm2_env.restart_time ? l.pm2_env.restart_time : 0); // CPU + Memory\n\n      obj[key].push(l.monit ? l.monit.cpu + '%' : 'N/A', l.monit ? UxHelpers.bytesToSize(l.monit.memory, 1) : 'N/A'); // User\n\n      if (!CONDENSED_MODE) {\n        if (l.pm2_env.uid && typeof l.pm2_env.uid == 'number') {\n          // Resolve user id to username\n          let users = Passwd.getUsers();\n          Object.keys(users).forEach(function (username) {\n            var user = users[username];\n\n            if (user.userId == l.pm2_env.uid) {\n              l.pm2_env.uid = user.username;\n            }\n          });\n        }\n\n        obj[key].push(chalk.bold(l.pm2_env.uid || l.pm2_env.username));\n      }\n\n      UxHelpers.safe_push(module_table, obj);\n    } else {\n      // pm2 ls for Applications\n      obj[key] = []; // PM2 ID\n\n      obj[key].push(l.pm2_env.name); // Namespace\n\n      if (!CONDENSED_MODE) obj[key].push(l.pm2_env.namespace); // Version\n\n      if (!CONDENSED_MODE) obj[key].push(l.pm2_env.version); // Exec mode\n\n      obj[key].push(mode == 'fork_mode' ? chalk.inverse.bold('fork') : chalk.blue.bold('cluster')); // PID\n\n      if (!CONDENSED_MODE) obj[key].push(l.pid); // Uptime\n\n      if (!CONDENSED_MODE) obj[key].push(l.pm2_env.pm_uptime && status == 'online' ? UxHelpers.timeSince(l.pm2_env.pm_uptime) : 0); // Restart\n\n      obj[key].push(l.pm2_env.restart_time ? l.pm2_env.restart_time : 0); // Status\n\n      obj[key].push(UxHelpers.colorStatus(status)); // CPU\n\n      obj[key].push(l.monit ? l.monit.cpu + '%' : 'N/A'); // Memory\n\n      obj[key].push(l.monit ? UxHelpers.bytesToSize(l.monit.memory, 1) : 'N/A'); // User\n\n      if (!CONDENSED_MODE) {\n        if (l.pm2_env.uid && typeof l.pm2_env.uid == 'number') {\n          // Resolve user id to username\n          let users = Passwd.getUsers();\n          Object.keys(users).forEach(function (username) {\n            var user = users[username];\n\n            if (user.userId == l.pm2_env.uid) {\n              l.pm2_env.uid = user.username;\n            }\n          });\n        }\n\n        obj[key].push(chalk.bold(l.pm2_env.uid || l.pm2_env.username));\n      } // Watch status\n\n\n      if (!CONDENSED_MODE) obj[key].push(l.pm2_env.watch ? chalk.green.bold('enabled') : chalk.grey('disabled'));\n      UxHelpers.safe_push(app_table, obj);\n    }\n  }); // Print Applications Managed\n\n  console.log(app_table.toString()); // Print Modules Managed\n\n  if (module_table.length > 0) {\n    console.log(chalk.bold(`Module${module_table.length > 1 ? 's' : ''}`));\n    console.log(module_table.toString());\n  }\n\n  proc_id++;\n} // Container display\n\n\nfunction containersListing(sys_infos) {\n  var stacked_docker = (process.stdout.columns || 100) < 140;\n  var docker_head = {\n    id: 4,\n    image: 50,\n    status: 10,\n    '↺': 6,\n    cpu: 10,\n    mem: 10,\n    'net I/O ⇵': 11,\n    'fs I/O ⇵': 11\n  };\n\n  if (stacked_docker) {\n    docker_head = {\n      id: 4,\n      image: 25,\n      status: 10,\n      cpu: 10,\n      mem: 10\n    };\n  }\n\n  var docker_table = new Table({\n    colWidths: Object.keys(docker_head).map(k => docker_head[k]),\n    head: Object.keys(docker_head),\n    colAligns: ['left'],\n    style: {\n      'padding-left': 1,\n      head: ['cyan', 'bold'],\n      compact: true\n    }\n  });\n  sys_infos.containers.forEach(c => {\n    var cpu = c.stats.cpu_percent;\n    var mem = c.stats.mem_percent == 0 ? '0' : c.stats.mem_percent;\n    var id = chalk.bold.cyan(proc_id++);\n    var state = UxHelpers.colorStatus(c.state);\n    if (stacked_docker) docker_table.push([id, c.image, state, `${cpu}%`, `${mem}mb`]);else {\n      docker_table.push([id, c.image, state, c.restartCount, `${cpu == 0 ? '0' : cpu}%`, `${mem}mb`, `${c.stats.netIO.rx}/${isNaN(c.stats.netIO.tx) == true ? '0.0' : c.stats.netIO.tx}`, `${c.stats.blockIO.r}/${c.stats.blockIO.w}`]);\n    }\n  });\n  console.log(chalk.bold(`Container${sys_infos.containers.length > 1 ? 's' : ''}`));\n  console.log(docker_table.toString());\n}\n/**\n * High resource processes\n */\n\n\nfunction listHighResourcesProcesses(sys_infos) {\n  const CPU_MIN_SHOW = 60;\n  const MEM_MIN_SHOW = 30;\n  var sys_proc_head = ['id', 'cmd', 'pid', 'cpu', 'mem', 'uid'];\n  var sys_proc_table = new Table({\n    colWidths: [4, CONDENSED_MODE ? 29 : 77, 10, 10, 10, 8],\n    head: sys_proc_head,\n    colAligns: ['left'],\n    style: {\n      'padding-left': 1,\n      head: ['cyan', 'bold'],\n      compact: true\n    }\n  });\n  sys_infos.processes.cpu_sorted = sys_infos.processes.cpu_sorted.filter(proc => {\n    return proc.cpu > CPU_MIN_SHOW && proc.cmd.includes('node') === false && proc.cmd.includes('God Daemon') === false;\n  });\n  sys_infos.processes.cpu_sorted.forEach(proc => {\n    var cpu = `${UxHelpers.colorizedMetric(proc.cpu, 40, 70, '%')}`;\n    var mem = `${UxHelpers.colorizedMetric(proc.memory, 40, 70, '%')}`;\n    var cmd = proc.cmd;\n    sys_proc_table.push([chalk.bold.cyan(proc_id++), cmd, proc.pid, cpu, mem, proc.uid]);\n  });\n  sys_infos.processes.mem_sorted = sys_infos.processes.mem_sorted.filter(proc => {\n    return proc.memory > MEM_MIN_SHOW && proc.cmd.includes('node') == false;\n  });\n  sys_infos.processes.mem_sorted.forEach(proc => {\n    var cpu = `${UxHelpers.colorizedMetric(proc.cpu, 40, 70, '%')}`;\n    var mem = `${UxHelpers.colorizedMetric(proc.memory, 40, 70, '%')}`;\n    var cmd = proc.cmd; // if (proc.cmd.length > 50)\n    //   cmd = '…' + proc.cmd.slice(proc.cmd.length - 48, proc.cmd.length)\n\n    sys_proc_table.push([chalk.bold.cyan(proc_id++), cmd, proc.pid, cpu, mem, proc.uid]);\n  });\n\n  if (sys_infos.processes.cpu_sorted.length >= 1 || sys_infos.processes.mem_sorted.length >= 1) {\n    console.log(chalk.bold('Intensive Processes'));\n    console.log(sys_proc_table.toString());\n  }\n}\n/**\n * Sys info line\n */\n\n\nfunction miniMonitBar(sys_infos) {\n  var sys_summary_line = `${chalk.bold.cyan('host metrics')} `;\n  sys_summary_line += `| ${chalk.bold('cpu')}: ${UxHelpers.colorizedMetric(sys_infos.cpu.usage, 40, 70, '%')}`;\n\n  if (sys_infos.cpu.temperature && sys_infos.cpu.temperature != '-1') {\n    sys_summary_line += ` ${UxHelpers.colorizedMetric(sys_infos.cpu.temperature, 50, 70, 'º')}`;\n  }\n\n  if (sys_infos.mem) {\n    var perc_mem_usage = (sys_infos.mem.available / sys_infos.mem.total * 100).toFixed(1);\n    sys_summary_line += ` | ${chalk.bold('mem free')}: ${UxHelpers.colorizedMetric(perc_mem_usage, 30, 10, '%')} `;\n  }\n\n  if (sys_infos.network) {\n    var latency = sys_infos.network.latency.toFixed(1);\n\n    if (latency == -1) {\n      sys_summary_line += `| ${chalk.bold('net')}: ${chalk.red('offline')} `;\n    } else {\n      sys_summary_line += `| ${chalk.bold('net')}: `; //sys_summary_line += `${colorizedMetric(latency, 100, 150, 'ms')} `\n\n      sys_summary_line += `⇓ ${UxHelpers.colorizedMetric(sys_infos.network.rx_5, 10, 20, 'mb/s')} `;\n      sys_summary_line += `⇑ ${UxHelpers.colorizedMetric(sys_infos.network.tx_5, 10, 20, 'mb/s')} `;\n    }\n  }\n\n  if (CONDENSED_MODE == false) {\n    if (sys_infos.storage) {\n      sys_summary_line += `| ${chalk.bold('disk')}: ⇓ ${UxHelpers.colorizedMetric(sys_infos.storage.io.read, 10, 20, 'mb/s')}`;\n      sys_summary_line += ` ⇑ ${UxHelpers.colorizedMetric(sys_infos.storage.io.write, 10, 20, 'mb/s')} `;\n    }\n\n    var disk_nb = 0;\n    sys_infos.storage.filesystems.forEach(fs => {\n      disk_nb++;\n      var perc_used = (fs.used / fs.size * 100).toFixed();\n      if (perc_used > 60) sys_summary_line += `${chalk.grey(fs.fs)} ${UxHelpers.colorizedMetric(perc_used, 80, 90, '%')} `;\n    });\n  }\n\n  sys_summary_line += '|';\n  console.log(sys_summary_line);\n}\n/**\n * pm2 ls\n * @method dispAsTable\n * @param {Object} list\n * @param {Object} system informations (via pm2 sysmonit/pm2 sysinfos)\n */\n\n\nmodule.exports = function (list, sys_infos) {\n  var pm2_conf = Configuration.getSync('pm2');\n  if (!list) return console.log('list empty');\n  listModulesAndAppsManaged(list);\n\n  if (sys_infos) {\n    if (sys_infos.containers && sys_infos.containers.length > 0 && pm2_conf && pm2_conf.show_docker == \"true\") containersListing(sys_infos);\n    if (sys_infos.processes && (sys_infos.processes.cpu_sorted || sys_infos.processes.mem_sorted)) listHighResourcesProcesses(sys_infos);\n    if (sys_infos.cpu && sys_infos.cpu.usage) miniMonitBar(sys_infos);\n  } //checkIfProcessAreDumped(list)\n\n};","map":{"version":3,"sources":["/Users/samianki/node_modules/pm2/lib/API/UX/pm2-ls.js"],"names":["cst","require","Common","Configuration","UxHelpers","chalk","Table","Passwd","List","CONDENSED_MODE","process","stdout","columns","checkIfProcessAreDumped","list","dump_raw","readFileSync","DUMP_FILE_PATH","dump","JSON","parse","apps_dumped","map","proc","name","apps_running","filter","pm2_env","pmx_module","diff","a","includes","length","printOut","italic","join","e","proc_id","listModulesAndAppsManaged","name_col_size","reduce","p","c","app_head","id","namespace","version","mode","pid","uptime","status","cpu","mem","user","watching","mod_head","module","memory","app_table","head","Object","keys","colWidths","k","colAligns","style","compact","module_table","sortField","sortOrder","sort","fields","b","fieldA","getNestedProperty","fieldB","forEach","l","obj","pm_id","exec_mode","key","bold","cyan","axm_options","is_tracing_enabled","tracing","enabled","green","_km_monitored","push","colorStatus","restart_time","monit","bytesToSize","uid","users","getUsers","username","userId","safe_push","inverse","blue","pm_uptime","timeSince","watch","grey","console","log","toString","containersListing","sys_infos","stacked_docker","docker_head","image","docker_table","containers","stats","cpu_percent","mem_percent","state","restartCount","netIO","rx","isNaN","tx","blockIO","r","w","listHighResourcesProcesses","CPU_MIN_SHOW","MEM_MIN_SHOW","sys_proc_head","sys_proc_table","processes","cpu_sorted","cmd","colorizedMetric","mem_sorted","miniMonitBar","sys_summary_line","usage","temperature","perc_mem_usage","available","total","toFixed","network","latency","red","rx_5","tx_5","storage","io","read","write","disk_nb","filesystems","fs","perc_used","used","size","exports","pm2_conf","getSync","show_docker"],"mappings":"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","sourcesContent":["\nconst cst = require('../../../constants')\nconst Common = require('../../Common')\nconst Configuration = require('../../Configuration')\nconst UxHelpers = require('./helpers.js')\nconst chalk = require('chalk')\nconst Table = require('cli-tableau')\nconst Passwd = require('../../tools/passwd.js')\n\nconst List = {}\n\nconst CONDENSED_MODE = (process.stdout.columns || 300) < 120\n\n/**\n * Check if dump file contains same apps that the one managed by PM2\n */\nfunction checkIfProcessAreDumped(list) {\n  try {\n    var dump_raw = require('fs').readFileSync(cst.DUMP_FILE_PATH)\n    var dump = JSON.parse(dump_raw)\n    var apps_dumped = dump.map(proc => proc.name)\n    var apps_running = list\n        .filter(proc => proc.pm2_env.pmx_module != true)\n        .map(proc => proc.name)\n    var diff = apps_dumped.filter(a => !apps_running.includes(a))\n    if (diff.length > 0) {\n      Common.printOut(`Current process list running is not in sync with saved list. ${chalk.italic(diff.join(' '))} differs. Type 'pm2 save' to synchronize.`)\n    }\n    else if (apps_dumped.length != apps_running.length) {\n      Common.printOut(`Current process list running is not in sync with saved list. Type 'pm2 save' to synchronize'`)\n    }\n  } catch(e) {\n  }\n}\n\nvar proc_id = 0\n\n/**\n * List Applications and Modules managed by PM2\n */\nfunction listModulesAndAppsManaged(list) {\n  var name_col_size = 11\n\n  if (list && list.length > 0)\n    name_col_size = (list.reduce((p, c) => (p.name.length > c.name.length) ? p : c)).name.length + 5\n\n  var app_head = {\n    id: 5,\n    name: name_col_size,\n    namespace: 13,\n    version: 9,\n    mode: 9,\n    pid: 10,\n    uptime: 8,\n    '↺': 6,\n    status: 11,\n    cpu: 10,\n    mem: 10,\n    user: 10,\n    watching: 10\n  }\n\n  var mod_head = {\n    id: 4,\n    module: 39,\n    version: 20,\n    pid: 7,\n    status: 10,\n    '↺': 6,\n    cpu: 10,\n    mem: 10,\n    user: 10\n  }\n\n  if (CONDENSED_MODE) {\n    app_head = {\n      id: 4,\n      name: 20,\n      mode: 10,\n      '↺': 6,\n      status: 11,\n      cpu: 10,\n      memory: 10\n    }\n\n    mod_head = {\n      id: 4,\n      name: 20,\n      status: 10,\n      cpu: 10,\n      mem: 10\n    }\n  }\n\n  var app_table = new Table({\n    head : Object.keys(app_head),\n    colWidths: Object.keys(app_head).map(k => app_head[k]),\n    colAligns : ['left'],\n    style : {'padding-left' : 1, head : ['cyan', 'bold'], compact : true}\n  })\n\n  var module_table = new Table({\n    head : Object.keys(mod_head),\n    colWidths: Object.keys(mod_head).map(k => mod_head[k]),\n    colAligns : ['left'],\n    style : {'padding-left' : 1, head : ['cyan', 'bold'],  compact : true}\n  })\n\n  var sortField = 'name', sortOrder = 'asc', sort,\n      fields = {\n        name: 'pm2_env.name',\n        namespace: 'pm2_env.namespace',\n        pid: 'pid',\n        id: 'pm_id',\n        cpu: 'monit.cpu',\n        memory: 'monit.memory',\n        uptime: 'pm2_env.pm_uptime',\n        status: 'pm2_env.status'\n      }\n\n  list.sort(function(a, b) {\n    var fieldA = UxHelpers.getNestedProperty(fields[sortField], a)\n    var fieldB = UxHelpers.getNestedProperty(fields[sortField], b)\n\n    if (sortOrder === 'desc') {\n      if (fieldA > fieldB)\n        return -1\n      if (fieldA < fieldB)\n        return 1\n    } else {\n      if (fieldA < fieldB)\n        return -1\n      if (fieldA > fieldB)\n        return 1\n    }\n    return 0\n  })\n\n  list.forEach(function(l) {\n    var obj = {}\n\n    if (l.pm2_env.pm_id > proc_id) {\n      proc_id = l.pm2_env.pm_id\n    }\n\n    var mode = l.pm2_env.exec_mode\n    var status = l.pm2_env.status\n    var key = l.pm2_env.pm_id\n    key = chalk.bold.cyan(key)\n\n    if (l.pm2_env.axm_options) {\n      var is_tracing_enabled = false\n\n      if (l.pm2_env.axm_options.tracing &&\n          typeof(l.pm2_env.axm_options.tracing) == 'boolean' &&\n          l.pm2_env.axm_options.tracing == true)\n        is_tracing_enabled = true\n\n      if (l.pm2_env.axm_options.tracing &&\n          l.pm2_env.axm_options.tracing.enabled &&\n          typeof(l.pm2_env.axm_options.tracing.enabled) == 'boolean' &&\n          l.pm2_env.axm_options.tracing.enabled == true)\n        is_tracing_enabled = true\n\n      if (is_tracing_enabled == true)\n        l.pm2_env.name = chalk.green('☵')  + ' ' + l.pm2_env.name\n\n      if (l.pm2_env._km_monitored)\n        l.pm2_env.name = chalk.bold.green('◉')  + ' ' + l.pm2_env.name\n    }\n\n    if (l.pm2_env.pmx_module == true) {\n      // pm2 ls for Modules\n      obj[key] = []\n\n      obj[key].push(l.name)\n\n      // Module version + PID\n      if (!CONDENSED_MODE) {\n        var pid = l.pm2_env.axm_options.pid ? l.pm2_env.axm_options.pid : l.pid\n        obj[key].push(l.pm2_env.version || 'N/A', pid)\n      }\n\n      // Status\n      obj[key].push(UxHelpers.colorStatus(status))\n\n      // Restart\n      if (!CONDENSED_MODE)\n        obj[key].push(l.pm2_env.restart_time ? l.pm2_env.restart_time : 0)\n\n      // CPU + Memory\n      obj[key].push(l.monit ? (l.monit.cpu + '%') : 'N/A', l.monit ? UxHelpers.bytesToSize(l.monit.memory, 1) : 'N/A' )\n\n      // User\n      if (!CONDENSED_MODE) {\n\n        if (l.pm2_env.uid && typeof(l.pm2_env.uid) == 'number') {\n          // Resolve user id to username\n          let users = Passwd.getUsers()\n          Object.keys(users).forEach(function(username) {\n            var user = users[username]\n            if (user.userId == l.pm2_env.uid) {\n              l.pm2_env.uid = user.username\n            }\n          })\n        }\n        obj[key].push(chalk.bold(l.pm2_env.uid || l.pm2_env.username))\n      }\n\n      UxHelpers.safe_push(module_table, obj)\n    }\n    else {\n      // pm2 ls for Applications\n      obj[key] = []\n\n      // PM2 ID\n      obj[key].push(l.pm2_env.name)\n\n      // Namespace\n      if (!CONDENSED_MODE)\n        obj[key].push(l.pm2_env.namespace)\n\n      // Version\n      if (!CONDENSED_MODE)\n        obj[key].push(l.pm2_env.version)\n\n      // Exec mode\n      obj[key].push(mode == 'fork_mode' ? chalk.inverse.bold('fork') : chalk.blue.bold('cluster'))\n\n      // PID\n      if (!CONDENSED_MODE)\n        obj[key].push(l.pid)\n\n      // Uptime\n      if (!CONDENSED_MODE)\n        obj[key].push((l.pm2_env.pm_uptime && status == 'online') ? UxHelpers.timeSince(l.pm2_env.pm_uptime) : 0)\n\n      // Restart\n      obj[key].push(l.pm2_env.restart_time ? l.pm2_env.restart_time : 0)\n\n      // Status\n      obj[key].push(UxHelpers.colorStatus(status))\n\n\n      // CPU\n      obj[key].push(l.monit ? l.monit.cpu + '%' : 'N/A')\n\n      // Memory\n      obj[key].push(l.monit ? UxHelpers.bytesToSize(l.monit.memory, 1) : 'N/A')\n\n      // User\n      if (!CONDENSED_MODE) {\n        if (l.pm2_env.uid && typeof(l.pm2_env.uid) == 'number') {\n          // Resolve user id to username\n          let users = Passwd.getUsers()\n          Object.keys(users).forEach(function(username) {\n            var user = users[username]\n            if (user.userId == l.pm2_env.uid) {\n              l.pm2_env.uid = user.username\n            }\n          })\n        }\n        obj[key].push(chalk.bold(l.pm2_env.uid || l.pm2_env.username))\n      }\n\n      // Watch status\n      if (!CONDENSED_MODE)\n        obj[key].push(l.pm2_env.watch ? chalk.green.bold('enabled') : chalk.grey('disabled'))\n\n      UxHelpers.safe_push(app_table, obj)\n    }\n\n  })\n\n  // Print Applications Managed\n  console.log(app_table.toString())\n\n  // Print Modules Managed\n  if (module_table.length > 0) {\n    console.log(chalk.bold(`Module${module_table.length > 1 ? 's' : ''}`))\n    console.log(module_table.toString())\n  }\n\n  proc_id++\n}\n\n// Container display\nfunction containersListing(sys_infos) {\n  var stacked_docker = (process.stdout.columns || 100) < 140\n\n  var docker_head = {\n    id: 4,\n    image: 50,\n    status: 10,\n    '↺': 6,\n    cpu: 10,\n    mem: 10,\n    'net I/O ⇵': 11,\n    'fs I/O ⇵': 11\n  }\n\n  if (stacked_docker) {\n    docker_head = {\n      id: 4,\n      image: 25,\n      status: 10,\n      cpu: 10,\n      mem: 10\n    }\n  }\n\n  var docker_table = new Table({\n    colWidths: Object.keys(docker_head).map(k => docker_head[k]),\n    head : Object.keys(docker_head),\n    colAligns : ['left'],\n    style : {'padding-left' : 1, head : ['cyan', 'bold'],  compact : true}\n  })\n\n  sys_infos.containers.forEach((c) => {\n    var cpu = c.stats.cpu_percent\n    var mem = c.stats.mem_percent == 0 ? '0' : c.stats.mem_percent\n    var id = chalk.bold.cyan(proc_id++)\n    var state = UxHelpers.colorStatus(c.state)\n\n    if (stacked_docker)\n      docker_table.push([id, c.image, state, `${cpu}%`, `${mem}mb`])\n    else {\n      docker_table.push([\n        id,\n        c.image,\n        state,\n        c.restartCount,\n        `${cpu == 0 ? '0' : cpu}%`,\n        `${mem}mb`,\n        `${c.stats.netIO.rx}/${isNaN(c.stats.netIO.tx) == true ? '0.0' : c.stats.netIO.tx}`,\n        `${c.stats.blockIO.r}/${c.stats.blockIO.w}`\n      ])\n    }\n  })\n\n  console.log(chalk.bold(`Container${sys_infos.containers.length > 1 ? 's' : ''}`))\n  console.log(docker_table.toString())\n}\n\n/**\n * High resource processes\n */\nfunction listHighResourcesProcesses(sys_infos) {\n  const CPU_MIN_SHOW = 60\n  const MEM_MIN_SHOW = 30\n\n  var sys_proc_head = ['id', 'cmd', 'pid', 'cpu', 'mem', 'uid']\n\n  var sys_proc_table = new Table({\n    colWidths: [4, CONDENSED_MODE ? 29 : 77, 10, 10, 10, 8],\n    head : sys_proc_head,\n    colAligns : ['left'],\n    style : {'padding-left' : 1, head : ['cyan', 'bold'],  compact : true}\n  })\n\n  sys_infos.processes.cpu_sorted = sys_infos.processes.cpu_sorted.filter((proc) => {\n    return proc.cpu > CPU_MIN_SHOW && proc.cmd.includes('node') === false &&\n      proc.cmd.includes('God Daemon') === false\n  })\n\n  sys_infos.processes.cpu_sorted.forEach(proc => {\n    var cpu = `${UxHelpers.colorizedMetric(proc.cpu, 40, 70, '%')}`\n    var mem = `${UxHelpers.colorizedMetric(proc.memory, 40, 70, '%')}`\n    var cmd = proc.cmd\n    sys_proc_table.push([chalk.bold.cyan(proc_id++), cmd, proc.pid, cpu, mem, proc.uid])\n  })\n\n  sys_infos.processes.mem_sorted = sys_infos.processes.mem_sorted.filter((proc) => {\n    return proc.memory > MEM_MIN_SHOW && proc.cmd.includes('node') == false\n  })\n\n  sys_infos.processes.mem_sorted.forEach((proc) => {\n    var cpu = `${UxHelpers.colorizedMetric(proc.cpu, 40, 70, '%')}`\n    var mem = `${UxHelpers.colorizedMetric(proc.memory, 40, 70, '%')}`\n    var cmd = proc.cmd\n    // if (proc.cmd.length > 50)\n    //   cmd = '…' + proc.cmd.slice(proc.cmd.length - 48, proc.cmd.length)\n    sys_proc_table.push([chalk.bold.cyan(proc_id++), cmd, proc.pid, cpu, mem, proc.uid])\n  })\n\n  if (sys_infos.processes.cpu_sorted.length >= 1 || sys_infos.processes.mem_sorted.length >= 1) {\n    console.log(chalk.bold('Intensive Processes'))\n    console.log(sys_proc_table.toString())\n  }\n}\n\n/**\n * Sys info line\n */\nfunction miniMonitBar(sys_infos) {\n  var sys_summary_line = `${chalk.bold.cyan('host metrics')} `\n  sys_summary_line += `| ${chalk.bold('cpu')}: ${UxHelpers.colorizedMetric(sys_infos.cpu.usage, 40, 70, '%')}`\n  if (sys_infos.cpu.temperature && sys_infos.cpu.temperature != '-1') {\n    sys_summary_line += ` ${UxHelpers.colorizedMetric(sys_infos.cpu.temperature, 50, 70, 'º')}`\n  }\n  if (sys_infos.mem) {\n    var perc_mem_usage = (((sys_infos.mem.available) / sys_infos.mem.total) * 100).toFixed(1)\n    sys_summary_line += ` | ${chalk.bold('mem free')}: ${UxHelpers.colorizedMetric(perc_mem_usage, 30, 10, '%')} `\n  }\n  if (sys_infos.network) {\n    var latency = (sys_infos.network.latency).toFixed(1)\n    if (latency == -1) {\n      sys_summary_line += `| ${chalk.bold('net')}: ${chalk.red('offline')} `\n    }\n    else {\n      sys_summary_line += `| ${chalk.bold('net')}: `\n      //sys_summary_line += `${colorizedMetric(latency, 100, 150, 'ms')} `\n      sys_summary_line += `⇓ ${UxHelpers.colorizedMetric(sys_infos.network.rx_5, 10, 20, 'mb/s')} `\n      sys_summary_line += `⇑ ${UxHelpers.colorizedMetric(sys_infos.network.tx_5, 10, 20, 'mb/s')} `\n    }\n  }\n  if (CONDENSED_MODE == false) {\n    if (sys_infos.storage) {\n      sys_summary_line += `| ${chalk.bold('disk')}: ⇓ ${UxHelpers.colorizedMetric(sys_infos.storage.io.read, 10, 20, 'mb/s')}`\n      sys_summary_line += ` ⇑ ${UxHelpers.colorizedMetric(sys_infos.storage.io.write, 10, 20, 'mb/s')} `\n    }\n    var disk_nb = 0\n\n    sys_infos.storage.filesystems.forEach(fs => {\n      disk_nb++\n      var perc_used = ((fs.used / fs.size) * 100).toFixed()\n      if (perc_used > 60)\n        sys_summary_line += `${chalk.grey(fs.fs)} ${UxHelpers.colorizedMetric(perc_used, 80, 90, '%')} `\n    })\n  }\n\n  sys_summary_line += '|'\n  console.log(sys_summary_line)\n}\n\n/**\n * pm2 ls\n * @method dispAsTable\n * @param {Object} list\n * @param {Object} system informations (via pm2 sysmonit/pm2 sysinfos)\n */\nmodule.exports = function(list, sys_infos) {\n  var pm2_conf = Configuration.getSync('pm2')\n\n  if (!list)\n    return console.log('list empty')\n\n  listModulesAndAppsManaged(list)\n\n  if (sys_infos) {\n    if (sys_infos.containers && sys_infos.containers.length > 0 &&\n        (pm2_conf && pm2_conf.show_docker == \"true\"))\n      containersListing(sys_infos)\n\n    if (sys_infos.processes && (sys_infos.processes.cpu_sorted || sys_infos.processes.mem_sorted))\n      listHighResourcesProcesses(sys_infos)\n\n    if (sys_infos.cpu && sys_infos.cpu.usage)\n      miniMonitBar(sys_infos)\n  }\n\n  //checkIfProcessAreDumped(list)\n}\n"]},"metadata":{},"sourceType":"script"}