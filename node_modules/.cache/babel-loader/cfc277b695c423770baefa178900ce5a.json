{"ast":null,"code":"/**\n * progressbar.js - progress bar element for blessed\n * Copyright (c) 2013-2015, Christopher Jeffrey and contributors (MIT License).\n * https://github.com/chjj/blessed\n */\n\n/**\n * Modules\n */\nvar Node = require('./node');\n\nvar Input = require('./input');\n/**\n * ProgressBar\n */\n\n\nfunction ProgressBar(options) {\n  var self = this;\n\n  if (!(this instanceof Node)) {\n    return new ProgressBar(options);\n  }\n\n  options = options || {};\n  Input.call(this, options);\n  this.filled = options.filled || 0;\n\n  if (typeof this.filled === 'string') {\n    this.filled = +this.filled.slice(0, -1);\n  }\n\n  this.value = this.filled;\n  this.pch = options.pch || ' '; // XXX Workaround that predates the usage of `el.ch`.\n\n  if (options.ch) {\n    this.pch = options.ch;\n    this.ch = ' ';\n  }\n\n  if (options.bch) {\n    this.ch = options.bch;\n  }\n\n  if (!this.style.bar) {\n    this.style.bar = {};\n    this.style.bar.fg = options.barFg;\n    this.style.bar.bg = options.barBg;\n  }\n\n  this.orientation = options.orientation || 'horizontal';\n\n  if (options.keys) {\n    this.on('keypress', function (ch, key) {\n      var back, forward;\n\n      if (self.orientation === 'horizontal') {\n        back = ['left', 'h'];\n        forward = ['right', 'l'];\n      } else if (self.orientation === 'vertical') {\n        back = ['down', 'j'];\n        forward = ['up', 'k'];\n      }\n\n      if (key.name === back[0] || options.vi && key.name === back[1]) {\n        self.progress(-5);\n        self.screen.render();\n        return;\n      }\n\n      if (key.name === forward[0] || options.vi && key.name === forward[1]) {\n        self.progress(5);\n        self.screen.render();\n        return;\n      }\n    });\n  }\n\n  if (options.mouse) {\n    this.on('click', function (data) {\n      var x, y, m, p;\n      if (!self.lpos) return;\n\n      if (self.orientation === 'horizontal') {\n        x = data.x - self.lpos.xi;\n        m = self.lpos.xl - self.lpos.xi - self.iwidth;\n        p = x / m * 100 | 0;\n      } else if (self.orientation === 'vertical') {\n        y = data.y - self.lpos.yi;\n        m = self.lpos.yl - self.lpos.yi - self.iheight;\n        p = y / m * 100 | 0;\n      }\n\n      self.setProgress(p);\n    });\n  }\n}\n\nProgressBar.prototype.__proto__ = Input.prototype;\nProgressBar.prototype.type = 'progress-bar';\n\nProgressBar.prototype.render = function () {\n  var ret = this._render();\n\n  if (!ret) return;\n  var xi = ret.xi,\n      xl = ret.xl,\n      yi = ret.yi,\n      yl = ret.yl,\n      dattr;\n  if (this.border) xi++, yi++, xl--, yl--;\n\n  if (this.orientation === 'horizontal') {\n    xl = xi + (xl - xi) * (this.filled / 100) | 0;\n  } else if (this.orientation === 'vertical') {\n    yi = yi + (yl - yi - ((yl - yi) * (this.filled / 100) | 0));\n  }\n\n  dattr = this.sattr(this.style.bar);\n  this.screen.fillRegion(dattr, this.pch, xi, xl, yi, yl);\n\n  if (this.content) {\n    var line = this.screen.lines[yi];\n\n    for (var i = 0; i < this.content.length; i++) {\n      line[xi + i][1] = this.content[i];\n    }\n\n    line.dirty = true;\n  }\n\n  return ret;\n};\n\nProgressBar.prototype.progress = function (filled) {\n  this.filled += filled;\n  if (this.filled < 0) this.filled = 0;else if (this.filled > 100) this.filled = 100;\n\n  if (this.filled === 100) {\n    this.emit('complete');\n  }\n\n  this.value = this.filled;\n};\n\nProgressBar.prototype.setProgress = function (filled) {\n  this.filled = 0;\n  this.progress(filled);\n};\n\nProgressBar.prototype.reset = function () {\n  this.emit('reset');\n  this.filled = 0;\n  this.value = this.filled;\n};\n/**\n * Expose\n */\n\n\nmodule.exports = ProgressBar;","map":{"version":3,"sources":["/Users/samianki/node_modules/blessed/lib/widgets/progressbar.js"],"names":["Node","require","Input","ProgressBar","options","self","call","filled","slice","value","pch","ch","bch","style","bar","fg","barFg","bg","barBg","orientation","keys","on","key","back","forward","name","vi","progress","screen","render","mouse","data","x","y","m","p","lpos","xi","xl","iwidth","yi","yl","iheight","setProgress","prototype","__proto__","type","ret","_render","dattr","border","sattr","fillRegion","content","line","lines","i","length","dirty","emit","reset","module","exports"],"mappings":"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","sourcesContent":["/**\n * progressbar.js - progress bar element for blessed\n * Copyright (c) 2013-2015, Christopher Jeffrey and contributors (MIT License).\n * https://github.com/chjj/blessed\n */\n\n/**\n * Modules\n */\n\nvar Node = require('./node');\nvar Input = require('./input');\n\n/**\n * ProgressBar\n */\n\nfunction ProgressBar(options) {\n  var self = this;\n\n  if (!(this instanceof Node)) {\n    return new ProgressBar(options);\n  }\n\n  options = options || {};\n\n  Input.call(this, options);\n\n  this.filled = options.filled || 0;\n  if (typeof this.filled === 'string') {\n    this.filled = +this.filled.slice(0, -1);\n  }\n  this.value = this.filled;\n\n  this.pch = options.pch || ' ';\n\n  // XXX Workaround that predates the usage of `el.ch`.\n  if (options.ch) {\n    this.pch = options.ch;\n    this.ch = ' ';\n  }\n  if (options.bch) {\n    this.ch = options.bch;\n  }\n\n  if (!this.style.bar) {\n    this.style.bar = {};\n    this.style.bar.fg = options.barFg;\n    this.style.bar.bg = options.barBg;\n  }\n\n  this.orientation = options.orientation || 'horizontal';\n\n  if (options.keys) {\n    this.on('keypress', function(ch, key) {\n      var back, forward;\n      if (self.orientation === 'horizontal') {\n        back = ['left', 'h'];\n        forward = ['right', 'l'];\n      } else if (self.orientation === 'vertical') {\n        back = ['down', 'j'];\n        forward = ['up', 'k'];\n      }\n      if (key.name === back[0] || (options.vi && key.name === back[1])) {\n        self.progress(-5);\n        self.screen.render();\n        return;\n      }\n      if (key.name === forward[0] || (options.vi && key.name === forward[1])) {\n        self.progress(5);\n        self.screen.render();\n        return;\n      }\n    });\n  }\n\n  if (options.mouse) {\n    this.on('click', function(data) {\n      var x, y, m, p;\n      if (!self.lpos) return;\n      if (self.orientation === 'horizontal') {\n        x = data.x - self.lpos.xi;\n        m = (self.lpos.xl - self.lpos.xi) - self.iwidth;\n        p = x / m * 100 | 0;\n      } else if (self.orientation === 'vertical') {\n        y = data.y - self.lpos.yi;\n        m = (self.lpos.yl - self.lpos.yi) - self.iheight;\n        p = y / m * 100 | 0;\n      }\n      self.setProgress(p);\n    });\n  }\n}\n\nProgressBar.prototype.__proto__ = Input.prototype;\n\nProgressBar.prototype.type = 'progress-bar';\n\nProgressBar.prototype.render = function() {\n  var ret = this._render();\n  if (!ret) return;\n\n  var xi = ret.xi\n    , xl = ret.xl\n    , yi = ret.yi\n    , yl = ret.yl\n    , dattr;\n\n  if (this.border) xi++, yi++, xl--, yl--;\n\n  if (this.orientation === 'horizontal') {\n    xl = xi + ((xl - xi) * (this.filled / 100)) | 0;\n  } else if (this.orientation === 'vertical') {\n    yi = yi + ((yl - yi) - (((yl - yi) * (this.filled / 100)) | 0));\n  }\n\n  dattr = this.sattr(this.style.bar);\n\n  this.screen.fillRegion(dattr, this.pch, xi, xl, yi, yl);\n\n  if (this.content) {\n    var line = this.screen.lines[yi];\n    for (var i = 0; i < this.content.length; i++) {\n      line[xi + i][1] = this.content[i];\n    }\n    line.dirty = true;\n  }\n\n  return ret;\n};\n\nProgressBar.prototype.progress = function(filled) {\n  this.filled += filled;\n  if (this.filled < 0) this.filled = 0;\n  else if (this.filled > 100) this.filled = 100;\n  if (this.filled === 100) {\n    this.emit('complete');\n  }\n  this.value = this.filled;\n};\n\nProgressBar.prototype.setProgress = function(filled) {\n  this.filled = 0;\n  this.progress(filled);\n};\n\nProgressBar.prototype.reset = function() {\n  this.emit('reset');\n  this.filled = 0;\n  this.value = this.filled;\n};\n\n/**\n * Expose\n */\n\nmodule.exports = ProgressBar;\n"]},"metadata":{},"sourceType":"script"}